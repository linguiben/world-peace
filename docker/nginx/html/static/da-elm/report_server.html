<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é¥¿äº†ä¹ˆæ¨èç³»ç»Ÿæ•°æ®åˆ†ææŠ¥å‘Š - ä¸šåŠ¡æ´å¯Ÿä»ªè¡¨ç›˜</title>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
<style>
    :root {
        font-size: 14px;
        --primary-color: #0091ff;
        --success-color: #52c41a;
        --warning-color: #faad14;
        --danger-color: #f5222d;
        --border-color: #e8e8e8;
    }
    
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        line-height: 1.6;
        padding: 1rem;
        min-height: 100vh;
    }
    
    .container {
        max-width: 1600px;
        margin: 0 auto;
    }
    
    .header {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        color: white;
        padding: 2rem;
        border-radius: 12px;
        margin-bottom: 1.5rem;
        box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        text-align: center;
    }
    
    .header h1 {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        font-weight: 600;
    }
    
    .header p {
        font-size: 1rem;
        opacity: 0.95;
        margin-bottom: 0.3rem;
    }
    
    .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
    }
    
    .metric-card {
        background: white;
        padding: 1.2rem;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        text-align: center;
        transition: transform 0.2s;
    }
    
    .metric-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    }
    
    .metric-label {
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 0.5rem;
    }
    
    .metric-value {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 0.3rem;
    }
    
    .metric-change {
        font-size: 0.85rem;
        color: var(--success-color);
    }
    
    .section {
        background: white;
        border-radius: 12px;
        margin-bottom: 1.5rem;
        padding: 1.5rem;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }
    
    .section-header {
        display: flex;
        align-items: center;
        margin-bottom: 1.2rem;
        padding-bottom: 1rem;
        border-bottom: 3px solid var(--primary-color);
    }
    
    .section-icon {
        font-size: 1.8rem;
        margin-right: 0.8rem;
    }
    
    .section-title {
        font-size: 1.4rem;
        font-weight: 600;
        color: #1a1a1a;
    }
    
    .section-subtitle {
        font-size: 0.9rem;
        color: #666;
        margin-left: auto;
    }
    
    .chart {
        height: 420px;
        width: 100%;
        margin-top: 1rem;
    }
    
    .chart-small {
        height: 320px;
    }
    
    .chart-medium {
        height: 380px;
    }
    
    .two-column {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
    }
    
    .table-wrapper {
        max-height: 500px;
        overflow: auto;
        margin-top: 1rem;
        border: 1px solid var(--border-color);
        border-radius: 8px;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9rem;
    }
    
    th, td {
        padding: 0.75rem 1rem;
        text-align: center;
        border-bottom: 1px solid var(--border-color);
    }
    
    th {
        background: linear-gradient(to bottom, #fafafa, #f0f0f0);
        font-weight: 600;
        color: #333;
        position: sticky;
        top: 0;
        z-index: 10;
    }
    
    tbody tr:hover {
        background-color: #f5f5f5;
    }
    
    .footer {
        text-align: center;
        color: white;
        padding: 1.5rem;
        margin-top: 2rem;
        background: rgba(255,255,255,0.1);
        border-radius: 8px;
        backdrop-filter: blur(10px);
    }
    
    .tag {
        display: inline-block;
        padding: 0.2rem 0.6rem;
        border-radius: 4px;
        font-size: 0.85rem;
        font-weight: 500;
    }
    
    .tag-vip {
        background: #fff7e6;
        color: #fa8c16;
        border: 1px solid #ffd591;
    }
    
    .tag-high {
        background: #f6ffed;
        color: #52c41a;
        border: 1px solid #b7eb8f;
    }
    
    .tag-medium {
        background: #e6f7ff;
        color: #1890ff;
        border: 1px solid #91d5ff;
    }
    
    .tag-low {
        background: #fff1f0;
        color: #ff4d4f;
        border: 1px solid #ffccc7;
    }
    
    @media (max-width: 768px) {
        .two-column {
            grid-template-columns: 1fr;
        }
        .metrics-grid {
            grid-template-columns: 1fr;
        }
        .header h1 {
            font-size: 1.5rem;
        }
    }
</style>
</head>
<body>

<div class="container">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="header">
        <h1>ğŸ” é¥¿äº†ä¹ˆæ¨èç³»ç»Ÿæ•°æ®åˆ†ææŠ¥å‘Š</h1>
        <p>åŸºäº1.28äº¿æ¡çœŸå®ä¸šåŠ¡æ—¥å¿—çš„æ·±åº¦æ´å¯Ÿ</p>
        <p style="font-size: 0.85rem; opacity: 0.8;">åˆ†ææ—¶æ®µ: 2022å¹´4æœˆ1æ—¥ | æ•°æ®è§„æ¨¡: 128,000,000æ¡è®°å½•</p>
    </div>
    
    <!-- æ ¸å¿ƒæŒ‡æ ‡æ¦‚è§ˆ -->
    <div class="metrics-grid">
        <div class="metric-card">
            <div class="metric-label">æ€»æ›å…‰é‡</div>
            <div class="metric-value">128.0M</div>
            <div class="metric-change">ğŸ“Š å…¨é‡æ•°æ®</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">æ€»ç‚¹å‡»é‡</div>
            <div class="metric-value">4.56M</div>
            <div class="metric-change">âœ… æ´»è·ƒç”¨æˆ·å“åº”</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">å…¨å±€ç‚¹å‡»ç‡ (CTR)</div>
            <div class="metric-value">3.56%</div>
            <div class="metric-change">ğŸ“ˆ è¡Œä¸šä¸­ä½æ°´å¹³</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">è½¬åŒ–ç‡ (CVR)</div>
            <div class="metric-value">28.5%</div>
            <div class="metric-change">ğŸ¯ æ¨èç²¾å‡†åº¦æŒ‡æ ‡</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">å¹³å‡å®¢å•ä»·</div>
            <div class="metric-value">Â¥48.5</div>
            <div class="metric-change">ğŸ’° ç”¨æˆ·æ¶ˆè´¹èƒ½åŠ›</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">æ´»è·ƒç”¨æˆ·æ•°</div>
            <div class="metric-value">45.2M</div>
            <div class="metric-change">ğŸ‘¥ ç‹¬ç«‹ç”¨æˆ·è®¿é—®</div>
        </div>
    </div>
    
    <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šç”¨æˆ·ç”»åƒåˆ†æ -->
    <div class="section">
        <div class="section-header">
            <span class="section-icon">ğŸ‘¥</span>
            <h2 class="section-title">ç”¨æˆ·å…¨æ™¯ç”»åƒä¸åˆ†å±‚è¿è¥</h2>
            <span class="section-subtitle">User Insights Â· RFMåˆ†å±‚æ¨¡å‹</span>
        </div>
        
        <div class="two-column">
            <div>
                <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: #555;">ç”¨æˆ·ä»·å€¼åˆ†å±‚åˆ†å¸ƒ</h3>
                <div id="userSegmentPie" class="chart chart-small"></div>
            </div>
            <div>
                <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: #555;">å„å±‚çº§ç”¨æˆ·å¹³å‡æ¶ˆè´¹é‡‘é¢</h3>
                <div id="userValueBar" class="chart chart-small"></div>
            </div>
        </div>
        
        <h3 style="font-size: 1.1rem; margin: 1.5rem 0 0.5rem; color: #555;">VIPä¼šå‘˜ vs æ™®é€šç”¨æˆ·å¯¹æ¯”</h3>
        <div id="vipComparison" class="chart chart-medium"></div>
        
        <h3 style="font-size: 1.1rem; margin: 1.5rem 0 0.5rem; color: #555;">ç”¨æˆ·åœ°ç†åˆ†å¸ƒçƒ­åŠ› (TOP 20åŸå¸‚)</h3>
        <div id="cityHeatmap" class="chart"></div>
    </div>
    
    <!-- ç¬¬äºŒéƒ¨åˆ†:å•†å“åˆ†æ -->
    <div class="section">
        <div class="section-header">
            <span class="section-icon">ğŸ”</span>
            <h2 class="section-title">å•†å“æ•ˆèƒ½ä¸å“ç±»è¶‹åŠ¿</h2>
            <span class="section-subtitle">Product Insights Â· æµé‡ä¸è½¬åŒ–åˆ†æ</span>
        </div>
        
        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: #555;">å•†å“ç‚¹å‡»çƒ­åº¦ TOP 30</h3>
        <div id="productRanking" class="chart"></div>
        
        <div class="two-column">
            <div>
                <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: #555;">å•†å“åˆ†ç±»ç‚¹å‡»å æ¯”</h3>
                <div id="categoryPie" class="chart chart-small"></div>
            </div>
            <div>
                <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: #555;">ä¸åŒä»·æ ¼åŒºé—´çš„ç‚¹å‡»è½¬åŒ–ç‡</h3>
                <div id="priceAnalysis" class="chart chart-small"></div>
            </div>
        </div>
        
        <h3 style="font-size: 1.1rem; margin: 1.5rem 0 0.5rem; color: #555;">æ¨èä½åºæ•ˆåº”åˆ†æ (é»„é‡‘ä½ç½®)</h3>
        <div id="rankEffect" class="chart chart-medium"></div>
    </div>
    
    <!-- ç¬¬ä¸‰éƒ¨åˆ†:è¡Œä¸ºåˆ†æ -->
    <div class="section">
        <div class="section-header">
            <span class="section-icon">ğŸ“Š</span>
            <h2 class="section-title">è¿è¥åœºæ™¯ä¸è¡Œä¸ºå†³ç­–</h2>
            <span class="section-subtitle">Behavioral Insights Â· æ—¶é—´ä¸è½¬åŒ–åˆ†æ</span>
        </div>
        
        <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: #555;">24å°æ—¶æµé‡è¶‹åŠ¿ (é»„é‡‘æ—¶æ®µæ´å¯Ÿ)</h3>
        <div id="hourlyTrend" class="chart"></div>
        
        <div class="two-column">
            <div>
                <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: #555;">å·¥ä½œæ—¥ vs å‘¨æœ«è¡Œä¸ºå¯¹æ¯”</h3>
                <div id="weekdayComparison" class="chart chart-small"></div>
            </div>
            <div>
                <h3 style="font-size: 1.1rem; margin-bottom: 0.5rem; color: #555;">è½¬åŒ–æ¼æ–—åˆ†æ</h3>
                <div id="conversionFunnel" class="chart chart-small"></div>
            </div>
        </div>
        
        <h3 style="font-size: 1.1rem; margin: 1.5rem 0 0.5rem; color: #555;">ä¸åŒæ—¶æ®µçš„å“ç±»åå¥½</h3>
        <div id="timeCategory" class="chart"></div>
    </div>
    
    <!-- ç¬¬å››éƒ¨åˆ†:æ•°æ®æ˜ç»†è¡¨ -->
    <div class="section">
        <div class="section-header">
            <span class="section-icon">ğŸ“‹</span>
            <h2 class="section-title">æ ¸å¿ƒæ•°æ®æ˜ç»†è¡¨</h2>
            <span class="section-subtitle">Data Summary Â· å…³é”®æŒ‡æ ‡æ±‡æ€»</span>
        </div>
        
        <div class="table-wrapper">
            <table id="summaryTable">
                <thead>
                    <tr>
                        <th>åˆ†æç»´åº¦</th>
                        <th>æŒ‡æ ‡åç§°</th>
                        <th>æ•°å€¼</th>
                        <th>å æ¯”/åŒæ¯”</th>
                        <th>è¯„çº§</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
    
    <!-- é¡µè„š -->
    <div class="footer">
        <p>Â© 2026 é¥¿äº†ä¹ˆæ¨èç³»ç»Ÿæ•°æ®åˆ†æé¡¹ç›® | åŸºäºçœŸå®ä¸šåŠ¡æ•°æ®çš„æ¢ç´¢æ€§åˆ†æ</p>
        <p style="font-size: 0.85rem; margin-top: 0.5rem; opacity: 0.9;">
            æŠ€æœ¯æ ˆ: Python 3.12 Â· Pandas Â· NumPy Â· Matplotlib Â· ECharts
        </p>
    </div>
</div>

<script>


// ========== æ•°æ®åŠ¨æ€åŠ è½½ (ä»JSONæ–‡ä»¶åŠ è½½) ==========

let metricsData = {};
let userSegmentData = [];
let userValueData = {};
let vipData = {};
let cityData = [];
let productData = {};
let categoryData = [];
let priceData = {};
let rankData = {};
let hourlyData = {};
let weekdayData = {};
let funnelData = [];
let timeCategoryData = {};
let summaryTableData = [];

async function loadData() {
    try {
        const [metrics, user, product, behavior, summary] = await Promise.all([
            fetch('metrics.json').then(r => r.json()),
            fetch('user.json').then(r => r.json()),
            fetch('product.json').then(r => r.json()),
            fetch('behavior.json').then(r => r.json()),
            fetch('summary.json').then(r => r.json())
        ]);
        
        metricsData = metrics.metrics;
        userSegmentData = user.user.segment_distribution;
        userValueData = user.user.segment_avg_consumption;
        vipData = user.user.vip_comparison;
        cityData = user.user.city_distribution;
        productData = product.product.top_products;
        categoryData = product.product.category_distribution;
        priceData = product.product.price_analysis;
        rankData = product.product.rank_effect;
        hourlyData = behavior.behavior.hourly_trend;
        weekdayData = behavior.behavior.weekday_comparison;
        funnelData = behavior.behavior.conversion_funnel;
        timeCategoryData = behavior.behavior.time_category_preference;
        summaryTableData = summary.summary_table;
        
        updateMetrics();
        initCharts();
        renderTable();
    } catch (error) {
        console.error('æ•°æ®åŠ è½½å¤±è´¥:', error);
        document.body.innerHTML = '<div style="text-align:center;padding:50px;"><h2>æ•°æ®åŠ è½½å¤±è´¥</h2><p>è¯·ç¡®ä¿JSONæ–‡ä»¶å­˜åœ¨äºoutputç›®å½•: metrics.json, user.json, product.json, behavior.json, summary.json</p><p>é”™è¯¯: ' + error.message + '</p></div>';
    }
}

// Update Metrics on Page
// Update Metrics on Page
function updateMetrics() {
    const m = metricsData;
    if (!m) return;
    
    // Helper to find metric card by label text
    const cards = document.querySelectorAll('.metric-card');
    cards.forEach(card => {
        const label = card.querySelector('.metric-label').textContent;
        const valueEl = card.querySelector('.metric-value');
        
        if (label.includes('æ€»æ›å…‰é‡')) valueEl.textContent = m.total_impressions_unit ? m.total_impressions + m.total_impressions_unit : m.total_impressions;
        if (label.includes('æ€»ç‚¹å‡»é‡')) valueEl.textContent = m.total_clicks_unit ? m.total_clicks + m.total_clicks_unit : m.total_clicks;
        if (label.includes('å…¨å±€ç‚¹å‡»ç‡')) valueEl.textContent = m.global_ctr + '%';
        if (label.includes('è½¬åŒ–ç‡')) valueEl.textContent = m.global_cvr + '%';
        if (label.includes('å¹³å‡å®¢å•ä»·')) valueEl.textContent = 'Â¥' + m.avg_price;
        if (label.includes('æ´»è·ƒç”¨æˆ·æ•°')) valueEl.textContent = m.active_users_unit ? m.active_users + m.active_users_unit : m.active_users;
    });
    
    // Update Header Info
    const headerP = document.querySelector('.header p:last-child');
    if (headerP) {
        headerP.textContent = `åˆ†ææ—¶æ®µ: 2022å¹´4æœˆ1æ—¥ | æ•°æ®è§„æ¨¡: ${m.total_impressions}æ¡è®°å½•`;
    }
}

// Initialize

// ========== å›¾è¡¨æ¸²æŸ“å‡½æ•° ==========

function initCharts() {
    // 1. ç”¨æˆ·åˆ†å±‚é¥¼å›¾
    const segmentChart = echarts.init(document.getElementById('userSegmentPie'));
    segmentChart.setOption({
        tooltip: { trigger: 'item', formatter: '{b}: {c}%<br/>å æ¯”: {d}%' },
        legend: { bottom: 0, data: userSegmentData.map(d => d.name) },
        series: [{
            type: 'pie',
            radius: ['40%', '70%'],
            avoidLabelOverlap: true,
            itemStyle: { borderRadius: 8, borderColor: '#fff', borderWidth: 2 },
            label: { show: true, formatter: '{b}\n{c}%' },
            data: userSegmentData.map(d => ({ 
                name: d.name, 
                value: d.value,
                itemStyle: { color: d.color }
            }))
        }]
    });
    
    // 2. ç”¨æˆ·ä»·å€¼æŸ±çŠ¶å›¾
    const valueChart = echarts.init(document.getElementById('userValueBar'));
    valueChart.setOption({
        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
        xAxis: { type: 'category', data: userValueData.categories },
        yAxis: { type: 'value', name: 'å¹³å‡æ¶ˆè´¹(å…ƒ)' },
        series: [{
            type: 'bar',
            data: userValueData.values,
            itemStyle: {
                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                    { offset: 0, color: '#83bff6' },
                    { offset: 1, color: '#188df0' }
                ]),
                borderRadius: [6, 6, 0, 0]
            },
            label: { show: true, position: 'top', formatter: 'Â¥{c}' }
        }]
    });
    
    // 3. VIPå¯¹æ¯”å›¾
    const vipChart = echarts.init(document.getElementById('vipComparison'));
    vipChart.setOption({
        tooltip: { trigger: 'axis' },
        legend: { data: ['VIPç”¨æˆ·', 'æ™®é€šç”¨æˆ·'], top: 0 },
        xAxis: { type: 'category', data: vipData.categories },
        yAxis: { type: 'value' },
        series: [
            {
                name: 'VIPç”¨æˆ·',
                type: 'bar',
                data: vipData.vip,
                itemStyle: { color: '#faad14', borderRadius: [6, 6, 0, 0] },
                label: { show: true, position: 'top' }
            },
            {
                name: 'æ™®é€šç”¨æˆ·',
                type: 'bar',
                data: vipData.normal,
                itemStyle: { color: '#8c8c8c', borderRadius: [6, 6, 0, 0] },
                label: { show: true, position: 'top' }
            }
        ]
    });
    
    // 4. åŸå¸‚çƒ­åŠ›å›¾
    const cityChart = echarts.init(document.getElementById('cityHeatmap'));
    cityChart.setOption({
        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
        grid: { left: 80, right: 20, bottom: 20, top: 30 },
        xAxis: { type: 'value', name: 'è®¢å•é‡(åƒ)' },
        yAxis: { 
            type: 'category', 
            data: cityData.map(d => d.name).reverse(),
            axisLabel: { fontSize: 11 }
        },
        series: [{
            type: 'bar',
            data: cityData.map(d => d.value).reverse(),
            itemStyle: {
                color: params => {
                    const colors = ['#c23531', '#d48265', '#91c7ae', '#749f83', '#6e7074'];
                    return colors[Math.floor(params.dataIndex / 4) % colors.length];
                },
                borderRadius: [0, 6, 6, 0]
            },
            label: { show: true, position: 'right', formatter: '{c}' }
        }]
    });
    
    // 5. å•†å“æ’åå›¾
    const productChart = echarts.init(document.getElementById('productRanking'));
    productChart.setOption({
        tooltip: { trigger: 'axis' },
        legend: { data: ['ç‚¹å‡»é‡', 'ç‚¹å‡»ç‡(%)'], top: 0 },
        grid: { left: 60, right: 60, bottom: 30, top: 50 },
        xAxis: { 
            type: 'category', 
            data: productData.items,
            axisLabel: { rotate: 45, fontSize: 10 }
        },
        yAxis: [
            { type: 'value', name: 'ç‚¹å‡»é‡', position: 'left' },
            { type: 'value', name: 'CTR(%)', position: 'right' }
        ],
        series: [
            {
                name: 'ç‚¹å‡»é‡',
                type: 'bar',
                data: productData.clicks,
                itemStyle: { 
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: '#667eea' },
                        { offset: 1, color: '#764ba2' }
                    ]),
                    borderRadius: [4, 4, 0, 0]
                }
            },
            {
                name: 'ç‚¹å‡»ç‡(%)',
                type: 'line',
                yAxisIndex: 1,
                data: productData.ctr,
                lineStyle: { width: 3, color: '#f5222d' },
                itemStyle: { color: '#f5222d' },
                symbol: 'circle',
                symbolSize: 6
            }
        ]
    });
    
    // 6. åˆ†ç±»é¥¼å›¾
    const categoryChart = echarts.init(document.getElementById('categoryPie'));
    categoryChart.setOption({
        tooltip: { trigger: 'item', formatter: '{b}: {c}%' },
        legend: { bottom: 0, data: categoryData.map(d => d.name) },
        series: [{
            type: 'pie',
            radius: '65%',
            data: categoryData,
            itemStyle: { borderRadius: 6, borderColor: '#fff', borderWidth: 2 },
            label: { formatter: '{b}\n{c}%' }
        }]
    });
    
    // 7. ä»·æ ¼åˆ†æå›¾
    const priceChart = echarts.init(document.getElementById('priceAnalysis'));
    priceChart.setOption({
        tooltip: { trigger: 'axis' },
        legend: { data: ['ç‚¹å‡»ç‡(%)', 'è½¬åŒ–ç‡(%)'], top: 0 },
        xAxis: { type: 'category', data: priceData.ranges },
        yAxis: { type: 'value', name: 'ç™¾åˆ†æ¯”(%)' },
        series: [
            {
                name: 'ç‚¹å‡»ç‡(%)',
                type: 'line',
                data: priceData.clicks,
                lineStyle: { width: 3, color: '#1890ff' },
                itemStyle: { color: '#1890ff' },
                areaStyle: { 
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: 'rgba(24,144,255,0.3)' },
                        { offset: 1, color: 'rgba(24,144,255,0.05)' }
                    ])
                }
            },
            {
                name: 'è½¬åŒ–ç‡(%)',
                type: 'line',
                data: priceData.conversion,
                lineStyle: { width: 3, color: '#52c41a' },
                itemStyle: { color: '#52c41a' },
                areaStyle: { 
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: 'rgba(82,196,26,0.3)' },
                        { offset: 1, color: 'rgba(82,196,26,0.05)' }
                    ])
                }
            }
        ]
    });
    
    // 8. æ¨èä½åºæ•ˆåº”
    const rankChart = echarts.init(document.getElementById('rankEffect'));
    rankChart.setOption({
        tooltip: { trigger: 'axis' },
        legend: { data: ['ç‚¹å‡»ç‡(%)', 'æ›å…‰é‡(ç™¾ä¸‡)'], top: 0 },
        xAxis: { type: 'category', data: rankData.positions },
        yAxis: [
            { type: 'value', name: 'CTR(%)', position: 'left' },
            { type: 'value', name: 'æ›å…‰é‡(M)', position: 'right' }
        ],
        series: [
            {
                name: 'ç‚¹å‡»ç‡(%)',
                type: 'bar',
                data: rankData.ctr,
                itemStyle: { 
                    color: params => {
                        const colors = ['#f5222d', '#fa8c16', '#fadb14', '#52c41a', '#1890ff', '#722ed1'];
                        return colors[params.dataIndex];
                    },
                    borderRadius: [6, 6, 0, 0]
                },
                label: { show: true, position: 'top', formatter: '{c}%' }
            },
            {
                name: 'æ›å…‰é‡(ç™¾ä¸‡)',
                type: 'line',
                yAxisIndex: 1,
                data: rankData.impressions.map(v => (v / 1000000).toFixed(1)),
                lineStyle: { width: 3, color: '#722ed1' },
                itemStyle: { color: '#722ed1' },
                symbol: 'circle',
                symbolSize: 8
            }
        ]
    });
    
    // 9. 24å°æ—¶è¶‹åŠ¿
    const hourChart = echarts.init(document.getElementById('hourlyTrend'));
    hourChart.setOption({
        tooltip: { trigger: 'axis' },
        legend: { data: ['ç‚¹å‡»æ•°', 'è®¢å•æ•°'], top: 0 },
        grid: { left: 60, right: 60, bottom: 30, top: 50 },
        xAxis: { 
            type: 'category', 
            data: hourlyData.hours,
            axisLabel: { fontSize: 10 }
        },
        yAxis: { type: 'value', name: 'æ•°é‡' },
        series: [
            {
                name: 'ç‚¹å‡»æ•°',
                type: 'line',
                data: hourlyData.clicks,
                smooth: true,
                lineStyle: { width: 3, color: '#1890ff' },
                areaStyle: { 
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: 'rgba(24,144,255,0.4)' },
                        { offset: 1, color: 'rgba(24,144,255,0.1)' }
                    ])
                }
            },
            {
                name: 'è®¢å•æ•°',
                type: 'line',
                data: hourlyData.orders,
                smooth: true,
                lineStyle: { width: 3, color: '#52c41a' },
                areaStyle: { 
                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                        { offset: 0, color: 'rgba(82,196,26,0.4)' },
                        { offset: 1, color: 'rgba(82,196,26,0.1)' }
                    ])
                }
            }
        ]
    });
    
    // 10. å·¥ä½œæ—¥å‘¨æœ«å¯¹æ¯”
    const weekChart = echarts.init(document.getElementById('weekdayComparison'));
    weekChart.setOption({
        tooltip: { trigger: 'axis' },
        legend: { data: ['å·¥ä½œæ—¥', 'å‘¨æœ«'], top: 0 },
        xAxis: { type: 'category', data: weekdayData.metrics },
        yAxis: { type: 'value' },
        series: [
            {
                name: 'å·¥ä½œæ—¥',
                type: 'bar',
                data: weekdayData.weekday,
                itemStyle: { color: '#1890ff', borderRadius: [6, 6, 0, 0] },
                label: { show: true, position: 'top' }
            },
            {
                name: 'å‘¨æœ«',
                type: 'bar',
                data: weekdayData.weekend,
                itemStyle: { color: '#52c41a', borderRadius: [6, 6, 0, 0] },
                label: { show: true, position: 'top' }
            }
        ]
    });
    
    // 11. è½¬åŒ–æ¼æ–—
    const funnelChart = echarts.init(document.getElementById('conversionFunnel'));
    funnelChart.setOption({
        tooltip: { trigger: 'item', formatter: '{b}: {c}' },
        series: [{
            type: 'funnel',
            left: '10%',
            top: 40,
            bottom: 40,
            width: '80%',
            min: 0,
            max: 128000000,
            minSize: '0%',
            maxSize: '100%',
            sort: 'descending',
            gap: 2,
            label: {
                show: true,
                position: 'inside',
                formatter: '{b}\n{c}'
            },
            labelLine: { show: false },
            itemStyle: { borderColor: '#fff', borderWidth: 1 },
            data: funnelData
        }]
    });
    
    // 12. æ—¶æ®µå“ç±»åå¥½
    const timeCatChart = echarts.init(document.getElementById('timeCategory'));
    timeCatChart.setOption({
        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
        legend: { data: timeCategoryData.categories, bottom: 0 },
        grid: { left: 100, right: 20, bottom: 80, top: 30 },
        xAxis: { type: 'value', name: 'ç‚¹å‡»å æ¯”(%)' },
        yAxis: { type: 'category', data: timeCategoryData.times },
        series: timeCategoryData.categories.map((cat, idx) => ({
            name: cat,
            type: 'bar',
            stack: 'total',
            data: timeCategoryData.data.map(row => row[idx]),
            label: { show: true, formatter: params => params.value > 5 ? params.value + '%' : '' }
        }))
    });
    
    // çª—å£å¤§å°è°ƒæ•´æ—¶é‡ç»˜
    window.addEventListener('resize', () => {
        [segmentChart, valueChart, vipChart, cityChart, productChart, 
         categoryChart, priceChart, rankChart, hourChart, weekChart, 
         funnelChart, timeCatChart].forEach(chart => chart.resize());
    });
}

// ========== æ˜ç»†è¡¨æ¸²æŸ“ ==========
function renderTable() {
    const tbody = document.getElementById('tableBody');
    summaryTableData.forEach(row => {
        const tr = document.createElement('tr');
        
        let ratingTag = '';
        if (row.rating === 'é«˜') ratingTag = '<span class="tag tag-high">ä¼˜ç§€</span>';
        else if (row.rating === 'ä¸­') ratingTag = '<span class="tag tag-medium">è‰¯å¥½</span>';
        else ratingTag = '<span class="tag tag-low">å¾…ä¼˜åŒ–</span>';
        
        tr.innerHTML = `
            <td>${row.dimension}</td>
            <td style="text-align: left; padding-left: 1.5rem;">${row.metric}</td>
            <td><strong>${row.value}</strong></td>
            <td>${row.compare}</td>
            <td>${ratingTag}</td>
        `;
        tbody.appendChild(tr);
    });
}

// ========== åˆå§‹åŒ– ==========

// ========== åˆå§‹åŒ– ==========
window.addEventListener('DOMContentLoaded', () => {
    loadData();
});

</script>
</body>
</html>
